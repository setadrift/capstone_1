# Sentiment Analysis on bagel shop reviews — comparing New York City & Montréal
Final Capstone Project for BrainStation's Data Science Bootcamp

As an experiment, I wanted to see if I could determine which city bagel lovers prefer, and in order to answer this, I started an analysis and posed this question: Can one compare the same types of restaurants on Yelp (in my case, restaurants that serve bagels) between two places (in my case, New York and Montreal) to determine which has the better product or service?

In order to start my investigation, I needed data. I decided to scrape the following attributes from Yelp to form my dataset:
- Restaurant name
- Customer name
- Customer location
- Review text
- Review rating (customer)
- Review date

I kept getting blocked from Yelp’s website when using Python’s web scraping libraries — Selenium and BeautifulSoup — and in the end I discovered a free Google Chrome extension called ‘Web Scraper’. I never once got blocked when using their service, and would recommend it.

I wanted to get a general idea of review and rating behaviour in both cities, so to begin my analysis I simply scraped a combined ~10,000 reviews & ratings from Yelp consisting of a variety of restaurant types. This wasn’t proving to be very helpful in terms of insights, so I dove right in to the bagel datasets, consisting of a combined ~7,300 reviews and ratings for New York and Montreal shops that sold bagels.

Once I read my CSV files containing the Yelp data into Python, I converted each of them into a Pandas DataFrame. Before my investigation, I made sure that each CSV consisted of the same columns as to make my cleaning process more streamlined.

I dropped unnecessary columns that were generated by the web scraper and renamed some columns for interpretability. There weren’t any null values or duplicates to take care of, however, I had to convert the ‘rating’ column since it was read in as a string. ‘5 star rating’ turned into a simple integer ‘5’.

I had a hunch during the scraping process that the star rating distribution would be very imbalanced, as I primarily only saw 5 and 4 star ratings. In the future, I would like to import more review data into an ML pipeline to balance out the dataset, as I believe this skewed results in the end. Moving forward, I binarized the rating column so that reviews with a rating of 4 and 5 become a 1 (positive) and every rating under 4 to become a 0 (negative). The class imbalance for Montreal was 25% negative and 75% positive, and for New York, 24% negative and 76% positive.

Looking at the review length distribution, there is a very similar distribution across the board for each star in each city, which gave me confidence that the model would be less biased.

Once I binarized the positive and negative reviews, I divided them into their own data frames with just the text column. Each review was then tokenized using TFIDF and 1-grams which were giving the most consistent results and clear topics. For topic modelling, I tried LSI, LDA and NMF.

The word weights for the negative review tokens where not very interpretable for LSI, however, I was able to determine the number of topics to use for my modelling based off of the topic strengths.

I was hopeful about LDA, but in the end due to my class imbalance and not enough negative review data, the overlap in meaning between positive and negative reviews made it difficult to make sense of the topics, so in the end I decided to go with NMF, which gave the most interpretable results and distinct topics.

I moved forward with two different sets of topics for negative and positive reviews. This differed between Montreal and New York, but not by much.

The process going forward consisted of mapping all of the reviews to topics, normalizing the topic weights to sum up to 1, and averaging the topic distributions for all reviews of a bagel shop to map that topic to the restaurant.

The process is seen clearly with my interactive Flourish visualization you can see here:

Flourish visualizations:

Positive Reviews - Topic Distribution (MTL)
https://public.flourish.studio/visualisation/6116741/
Negative Reviews - Topic Distribution (MTL) 
https://public.flourish.studio/visualisation/6124425/
Positive Reviews - Topic Distribution (NYC)
https://public.flourish.studio/visualisation/6162285/
Negative Reviews - Topic Distribution (NYC)
https://public.flourish.studio/visualisation/6162243/

Full Medium Article: 
https://duncan-kg-anderson.medium.com/sentiment-analysis-on-bagel-shop-reviews-comparing-new-york-city-montr%C3%A9al-ffc4ef65a76f
